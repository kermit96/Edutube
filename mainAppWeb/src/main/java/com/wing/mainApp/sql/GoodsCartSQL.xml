<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cart">
<!-- 	이미 같은 내역을 구매한적이 있는지 확인하는 질의 -->
	<select id="selectCartInfo" 	resultType="java.lang.Integer"
									parameterType="cartdata">
		SELECT
			COUNT(*) AS CNT
		FROM
			GoodsCart
		WHERE
					gc_ID = #{id}
			AND	gc_GoodsNo = #{no}
	</select>
<!-- 	새로운 상품을 등록하는 질의 -->
	<insert id="insertCart" 	parameterType="cartdata">
		INSERT
		INTO
			GoodsCart
		VALUES
			(#{id}, #{no}, #{count}, SYSDATE)
	</insert>
<!-- 	구매 내역을 수정하는 질의 -->
	<update id="updateCart"	parameterType="cartdata">
		UPDATE
			GoodsCart
		SET
			gc_Count = gc_Count + #{count}
		WHERE
					gc_ID = #{id}
			AND	gc_GoodsNo = #{no}
	</update>
<!-- 	장바구니 목록 검색 질의 -->
	<select id="cartList"		resultType="gdata"
								parameterType="java.lang.String">
		SELECT
			gi.gi_Name						AS name,
			gi.gi_Maker					AS maker,
			gi.gi_Price						AS price,
			gi.gi_GoodsImg				AS gimg2,
			gc.gc_ID						AS id,
			gc.gc_GoodsNo				AS no,
			gc.gc_Count					AS count,
			gi.gi_Price * gc.gc_Count		AS total		
		FROM
			GoodsInfo gi, GoodsCart gc
		WHERE
					gi.gi_NO = gc.gc_GoodsNo
			AND 	gc.gc_ID = #{id}
	</select>
<!-- 	장바구니 수량 수정 질의 -->
	<update id="updateCartCount"	parameterType="cartdata">
		UPDATE
			GoodsCart
		SET
			gc_Count = #{count}
		WHERE
					gc_ID = #{id}
			AND	gc_GoodsNo = #{no}
	</update>
<!-- 	장바구니 삭제 질의 -->	
	<delete id="deleteCart"	parameterType="cartdata">
		DELETE
		FROM
			GoodsCart
		WHERE
					gc_ID = #{id}
			AND	gc_GoodsNo = #{no}
	</delete>	
</mapper>

