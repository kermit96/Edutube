<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="goodsmanager">
<!-- 	대카테고리 검색 질의 -->
	<select id="selectLCate"		resultType="gcate">
		SELECT
			gc_NO		AS no, 
			gc_Code	AS code,
			gc_Name	AS name
		FROM
			GoodsCate
		WHERE
			gc_Code LIKE '____'
		ORDER BY
			gc_Code ASC
	</select>
<!-- 	대카테고리 등록 질의 -->	
	<insert id="insertLCate"	parameterType="gcate">
		INSERT
		INTO
			GoodsCate
		VALUES(
			(SELECT NVL(MAX(gc_NO), 0) + 1 FROM GoodsCate), 
			(SELECT 'L' || LPAD(NVL(MAX(TO_NUMBER(SUBSTR(gc_Code, 2))), 0) + 1, 3, '0') FROM GoodsCate WHERE gc_Code LIKE '____'), 
			#{lname})
	</insert>
<!-- 	중 카테고리 등록 질의 -->	
	<insert id="insertMCate"	parameterType="gcate">
		INSERT
		INTO
			GoodsCate
		VALUES(
			(SELECT NVL(MAX(gc_NO), 0) + 1 FROM GoodsCate), 
			(SELECT #{lcode} || 'M' || LPAD(NVL(MAX(TO_NUMBER(SUBSTR(gc_Code, 6))), 0) + 1, 3, '0') FROM GoodsCate WHERE gc_Code LIKE #{lcode} || '____'), 
			#{mname})
	</insert>
<!-- 	소 카테고리 등록 질의	-->	
	<insert id="insertSCate"	parameterType="gcate">
		INSERT
		INTO
			GoodsCate
		VALUES(
			(SELECT NVL(MAX(gc_NO), 0) + 1 FROM GoodsCate), 
			(SELECT #{mcode} || 'S' || LPAD(NVL(MAX(TO_NUMBER(SUBSTR(gc_Code, 10))), 0) + 1, 3, '0') FROM GoodsCate WHERE gc_Code LIKE #{mcode} || '____'), 
			#{sname})
	</insert>
<!-- 	중 카테고리 검색 함수 -->
	<select id="selectMCate"		resultType="gcate" 
										parameterType="java.lang.String">
		SELECT
			gc_NO		AS no, 
			gc_Code	AS code,
			gc_Name	AS name
		FROM
			GoodsCate
		WHERE
			gc_Code LIKE #{cate} || '____'
		ORDER BY
			gc_Code ASC
	</select>
<!-- 	소 카테고리 검색 함수 -->
	<select id="selectSCate"		resultType="gcate" 
									parameterType="java.lang.String">
		SELECT
			gc_NO		AS no, 
			gc_Code	AS code,
			gc_Name	AS name
		FROM
			GoodsCate
		WHERE
			gc_Code LIKE #{cate} || '____'
		ORDER BY
			gc_Code ASC
	</select>
<!-- 	상품 등록 질의 -->
	<insert id="insertGoodsInfo"	parameterType="gdata">
		INSERT
		INTO
			GoodsInfo
		VALUES((SELECT NVL(MAX(gi_NO), 0) + 1 FROM GoodsInfo), 
		#{scode}, #{name}, #{maker}, #{price}, #{origin}, #{gimg2}, #{iimg2})	
	</insert>
	
<!-- 	상품 목록 검색 질의	-->
	<select id="selectGoodsList"		resultType="gdata"
										parameterType="java.util.HashMap">
		SELECT
			gi_NO			AS no,
			gi_Name		AS name,
			gi_Maker		AS maker,
			gi_Price		AS price,
			gi_GoodsImg	AS gimg2
		FROM
			GoodsInfo
		WHERE
		<if test="KIND eq 'LARGE'">
			gi_Cate LIKE #{CODE} || '________'
		</if>
		<if test="KIND eq 'MIDDLE'">
			gi_Cate LIKE #{CODE} || '____'
		</if>
		<if test="KIND eq 'SMALL'">
			gi_Cate LIKE #{CODE}
		</if>
		ORDER BY
<!-- 	상품을 출력하는 순서는 쇼핑몰마다 다르다. -->
			gi_NO DESC
	</select>
<!-- 	상품 상세보기 정보 검색 질의	-->	
	<select id="selectGoodsInfo"		resultType="gdata"
										parameterType="java.lang.Integer">
		SELECT
			gi_NO			AS no,
			gi_Cate		AS scode,
			gi_Name		AS name,
			gi_Maker		AS maker,
			gi_Price		AS price,
			gi_Original		AS origin,
			gi_GoodsImg	AS gimg2,
			gi_InfoImg		AS iimg2
		FROM
			GoodsInfo
		WHERE
			gi_NO = #{no}
	</select>
	
	
	
</mapper>








