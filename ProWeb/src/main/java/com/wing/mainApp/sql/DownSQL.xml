<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="down">
<!-- 총데이터 갯수 알려줌 -->	
	<select		id="getTotal"	resultType="java.lang.Integer">
		SELECT
			COUNT(*) AS TOTAL
		FROM
			DownLoad
		WHERE
			Down_IsDeleted = 'N'
	</select>
	
	<!-- 게시물 목록 -->
	<select		id="getList"	resultType="dwdata"		
									parameterType="java.util.HashMap">
		SELECT
			Down_NO 		AS no,
			Down_TITLE 	AS title,
			Down_Body 	AS body,
			Down_Date	AS wdate
		FROM 
			DownLoad
		WHERE
			Down_IsDeleted='N'		
	</select>
	
	
	<!-- 일련번호 구하기 -->
	<select id="selectMax"	resultType="java.lang.Integer">
		SELECT
			NVL(MAX(Down_NO), 0) + 1		AS NO
		FROM
			DownLoad
	</select>
	
	<!-- 첨부 파일 등록 -->
	<insert		id="insertFile" parameterType="dwdata">
		INSERT
		INTO
			UpLoad
		VALUES
			((SELECT NVL(MAX(UpLoad_NO), 0) + 1 FROM UpLoad), #{no}, #{path}, 
			#{oriname}, #{savename}, #{len}, SYSDATE, 'N')
	</insert>
	
	<!-- 	게시물 등록하기 -->
	<insert		id="insertBoard"	parameterType="dwdata">
		INSERT
		INTO
			DownLoad
		VALUES
			(#{no}, #{id}, #{title}, #{body}, SYSDATE, SYSDATE, 'N')
	</insert>
	
</mapper>